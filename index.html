<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Job Parser</title>
  <link rel="stylesheet" href="/index.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>

</head>
<body>
  <div class="container">
    <h1>Job Parser</h1>
    <!-- Dropdown menu for language selection -->
    <label for="languageSelect">Select Language:</label>
    <select id="languageSelect">
      <option value="id">Indonesia</option>
      <option value="en" selected>English</option>
      <option value="es">Spanish</option>
      <option value="de">German</option>
      <option value="ms">Malay</option>
      <option value="fil">Filipino</option>
    </select>
    <br>
    <!-- Textarea for entering job description -->
    <textarea id="jobTextInput" placeholder="Paste job description here..." rows="10"></textarea>

    <!-- Button to trigger the parsing -->
    <button id="parseButton">Parse Job Description</button>

    <!-- Output for parsed job details -->
    <div  style="text-align: left;" id="output"></div>

    <!-- Netlify Form to submit parsed data -->
    <form name="jobForm" method="POST" data-netlify="true" id="netlifyForm">
  <input type="hidden" name="form-name" value="jobForm">
      
  <input type="hidden" name="jobTitle" id="jobTitle">
        <input type="hidden" name="slug" id="slug">
  <input type="hidden" name="companyName" id="companyName">
  <input type="hidden" name="location" id="location">
  <input type="hidden" name="jobType" id="jobType">
  <input type="hidden" name="applyLink" id="applyLink">
  <input type="hidden" name="jobHighlights" id="jobHighlights">
  <input type="hidden" name="qualifications" id="qualifications">
  <input type="hidden" name="benefits" id="benefits">
  <input type="hidden" name="responsibilities" id="responsibilities">
  <input type="hidden" name="jobDescription" id="jobDescription">

  <input type="hidden" name="snippet" id="snippet">

  <!-- Additional fields that are in the JavaScript code but missing from the HTML -->
  <input type="hidden" name="currency" id="currency">
  <input type="hidden" name="salary" id="salary">
  <input type="hidden" name="timeworking" id="timeworking">
  <input type="hidden" name="education" id="education">
  
  <input type="hidden" name="googleMapsIframe" id="googleMapsIframe"> <!-- Added googleMapsIframe -->
  <input type="hidden" name="jsonLDScript" id="jsonLDScript"> <!-- Added jsonLDScript -->


      
      <button type="submit">Submit to Netlify Form</button>
    </form>
    <br><br>

    <b>HTML part to add a new textarea</b>
    <div>
      <textarea id="parsedResultsTextarea" rows="10" cols="50" readonly>  
      </textarea>
    </div>
    
  <div style="text-align: left;">
  <p><strong>Penjelasan Kode:</strong></p>

  <p><strong>HTML:</strong></p>
  <p>Body HTML yang dibutuhkan diawali dengan tag berikut:</p>
  <pre>
    &lt;c-wiz jsrenderer="kpn7Sd"&gt;
  </pre>
  <pre>
    &lt;c-wiz jsrenderer="EU1dwe"&gt;
  </pre>
  <p>Selanjutnya, ditambahkan input tersembunyi untuk setiap elemen yang ingin dikirim ke Netlify.</p>
  <p>Ada sebuah formulir yang menggunakan atribut <code>data-netlify="true"</code> <br>
    untuk mengirimkan data ke Netlify tanpa memerlukan backend tambahan.</p>

  <p><strong>JavaScript:</strong></p>
  <p>Script ini menggunakan <code>DOMParser</code> untuk memproses input HTML yang dimasukkan dalam textarea.</p>
  <p>Elemen-elemen yang relevan diekstrak berdasarkan marker yang diberikan, seperti:</p>
  <ul>
    <li><code>.LZAQDf.cS4Vcb-pGL6qe-IRrXtf</code> untuk <strong>jobTitle</strong></li>
    <li><code>.BK5CCe.cS4Vcb-pGL6qe-lfQAOe</code> untuk <strong>companyName</strong></li>
    <li>dan seterusnya...</li>
  </ul>
  <p>Inspect, Select selector, Edit HTML, select all , copy!<br>
    Hasil parsing akan ditampilkan dalam elemen <code>&lt;div id="output"&gt;</code> agar pengguna dapat melihat hasilnya.</p>
  <p>Data kemudian disiapkan untuk dikirimkan ke Netlify dengan mengisi input tersembunyi di formulir.</p>

  <p><strong>Netlify Form Setup:</strong></p>
  <p>Formulir dikirimkan ke Netlify secara otomatis setelah data diisi. Anda juga dapat menambahkan tombol kirim manual jika diperlukan.</p>
  <p>Dengan skrip ini, saat pengguna memasukkan HTML yang relevan dalam textarea dan menekan tombol "Parse Job Description", data akan diurai dan dikirimkan ke formulir Netlify.</p>
  <p>Perlu diingat bahwa <code>GITHUB_TOKEN</code> harus diletakkan di variabel lingkungan Netlify agar proses ini berjalan lancar.</p>
</div>



    
  </div>



  <script src="/form-sender.js?ref=123"></script>


  <script>


// Supabase configuration
const supabaseUrl = 'https://kbuiddaciduxktywsuna.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtidWlkZGFjaWR1eGt0eXdzdW5hIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzUxNzM3MTQsImV4cCI6MjA1MDc0OTcxNH0.jcqqGp6lluR2cZRU6IbSKlrLT8QecRJRVX0jCNVXKdU';
const supabase = createClient(supabaseUrl, supabaseKey);

// Handle form submission
document.getElementById('parseButton').addEventListener('click', async () => {
const jobData = {
    jobTitle: document.getElementById('jobTitle').value || null,
    slug: document.getElementById('slug').value || null,
    companyName: document.getElementById('companyName').value || null,
    location: document.getElementById('location').value || null,
    jobType: document.getElementById('jobType').value || null,
    applyLink: document.getElementById('applyLink').value || null,
    jobHighlights: document.getElementById('jobHighlights').value || null,
    qualifications: document.getElementById('qualifications').value || null,
    benefits: document.getElementById('benefits').value || null,
    responsibilities: document.getElementById('responsibilities').value || null,
    jobDescription: document.getElementById('jobDescription').value || null,
    snippet: document.getElementById('snippet').value || null,
    currency: document.getElementById('currency').value || null,
    salary: document.getElementById('salary').value || null,
    timeworking: document.getElementById('timeworking').value || null,
    education: document.getElementById('education').value || null,
    googleMapsIframe: document.getElementById('googleMapsIframe').value || null,
    jsonLDScript: document.getElementById('jsonLDScript').value || null,
};

const jobData = {
    jobTitle: 'Sample Job',
    companyName: 'Sample Company',
    location: 'Sample Location',
    jobType: 'Full-time',
    applyLink: 'https://example.com/apply',
    jobDescription: 'This is a sample job description for testing purposes.',
};


   alert('Job Data: ' + JSON.stringify(jobData)); // Alert job data for debugging

    try {
        const response = await supabase.from('jobPost').insert([jobData]);

        if (response.error) {
            alert('Supabase Error: ' + response.error.message);
        } else if (response.data) {
            alert('Job description submitted successfully! Data: ' + JSON.stringify(response.data));
        } else {
            alert('Unexpected response format.');
        }
    } catch (error) {
        alert('Unexpected error: ' + error.message);
    }


});


    
  </script>
  <br>

</body>
</html>
